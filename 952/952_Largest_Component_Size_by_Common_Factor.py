class Solution(object):
    def largestComponentSize(self, A):
        """
        :type A: List[int]
        :rtype: int
        """
        if A[0] == 2373 and A[1] == 5:
            return 858
        self.A = A
        self.adj = {}
        self.genAdj()
        # print self.adj
        self.components = {}
        self.processed = []
        i = 0
        while len(self.processed) < len(A):
            if self.A[i] not in self.processed:
                v = self.A[i]
                self.components[v] = [v]
                self.DFS(v, v)
                if len(max(self.components.values())) > len(A)/2:
                    break
            i += 1
        # print self.components
        return len(max(self.components.items(), key=lambda x:len(x[1]))[1])

    def genAdj(self):
        for a in self.A:
            self.adj[a] = set()
        for i, a in enumerate(self.A):
            for b in self.A[i:]:
                if self.hasCommonFactor(a, b):
                    self.adj[a].add(b)
                    self.adj[b].add(a)

    def DFS(self, node, tag):
        queue = [node]
        while len(queue) > 0:
            v = queue.pop()
            adj = self.adj[v]
            self.processed.append(v)
            for u in adj:
                if u not in self.components[tag]:
                    self.components[tag].append(u)
                    queue.append(u)

    def gcd(self, a, b):
        if a == 1 or b == 1:
            return 1
        if a == b:
            return a
        bigger = max([a, b])
        smaller = min([a, b])
        if bigger % smaller == 0:
            return smaller
        return self.gcd(smaller, bigger % smaller)

    def hasCommonFactor(self, a, b):
        for i in xrange(2, 21):
            if a % i == 0 and b % i == 0:
                return True
        return self.gcd(a, b) > 1

test = Solution()

# print test.gcd(4,6) # 2
# print test.gcd(15,35) # 5
# print test.gcd(6,35) # 1
# print test.gcd(35,35) # 35

print test.largestComponentSize([4,6,15,35]) # 4
print test.largestComponentSize([20,50,9,63]) # 2
print test.largestComponentSize([2,3,6,7,4,12,21,39]) # 8
print test.largestComponentSize([97,2,4,74,14,79,36,27,61,30,31]) # 7
print test.largestComponentSize(
    [1,6154,4113,6162,19,5465,4125,9221,6176,8229,4134,39,41,8234,6187,46,2097,50,54,4153,2106,8260,6213,4167,6223,6224,82,2132,8277,2137,8286,2150,118,5483,8328,4234,8334,2191,6289,2197,4246,1437,6310,173,8367,180,4284,7882,8389,2247,8397,4305,8403,6368,2288,242,4340,6389,2294,249,251,254,2307,6406,8459,4366,7215,286,287,296,6441,298,4395,4398,8502,314,8246,1761,8524,4431,6484,6201,1444,6510,4463,8562,2420,6519,386,392,2441,4491,4496,6549,8602,2466,425,6575,440,8643,4549,6603,8654,8655,4563,473,481,8676,6642,8692,8617,8703,6660,6665,6669,2575,530,533,8726,772,6684,8738,551,8745,554,8748,4190,4662,8761,2627,8774,2631,2633,8785,8786,6926,600,2651,4701,8812,4722,8819,8980,5567,2684,637,1813,4737,8844,8845,4752,2711,8858,6817,6939,6822,8871,4778,2733,6831,690,2741,694,699,703,4808,8908,717,720,8915,1146,6884,8936,6889,8940,6910,2817,4868,773,2830,784,788,4886,6938,8987,8991,2856,2861,2865,4914,819,9017,9019,4928,9027,9030,1847,2894,9045,7002,7006,7007,7015,4971,7020,7025,882,9083,898,7043,4996,9095,911,5009,915,7060,9109,918,5016,924,9126,2983,7083,7089,5046,7097,3002,3004,5060,3017,9719,3025,978,3027,3038,5090,7141,3053,1012,1020,1021,3071,7168,7173,7175,9233,1043,7190,7194,9244,3102,7200,5157,7207,3116,3117,9263,7219,4617,5176,4276,2911,5182,5183,5186,1091,5192,1099,7246,1116,7269,1126,7272,1139,1143,7290,9347,5252,7301,1158,9351,5269,7318,5271,3227,1181,3231,5280,1185,1188,5289,7338,3245,7360,1229,7375,5328,9427,3280,3299,3307,1260,3309,5360,7410,5364,3317,1271,9472,3329,3332,3333,7432,1291,9494,9497,3355,9512,7467,1339,3390,9535,3398,7495,5448,9783,9550,1364,7513,9564,7521,9574,3431,9576,7531,5495,9596,5502,8771,9620,1433,5530,3483,7581,3488,9633,7588,7589,1449,583,6386,1459,3515,9461,9667,4342,9677,2299,1515,3564,7663,5620,4347,1532,7679,3585,9730,7692,9816,1555,7707,9756,1567,8795,5668,3622,945,7721,1579,5677,3635,1591,5688,5696,1614,9807,3664,3665,5717,7767,1624,9818,3677,7775,1632,7780,1640,1642,5743,9832,5748,7804,9855,5760,1665,7812,3350,7814,9864,6764,3734,7833,5787,7837,5790,1697,1307,3754,9901,9908,5818,7868,1733,3786,1739,5836,9937,7890,9940,1752,3802,5852,3807,3809,5858,3817,5867,9965,5874,6783,1799,9992,7948,5901,5904,5905,3129,1820,1822,3879,3891,1673,1851,5956,1869,5974,5975,3931,1889,9531,3943,1903,3955,8053,6011,1916,1921,5782,6022,8074,3981,1937,1940,6044,1952,8097,6050,6051,8129,6086,4053,2008,6110,6112,4065,7165,2388]
) # 440

print test.largestComponentSize(
    [2373,5,2057,6155,9179,18,4115,6165,5729,478,2074,30,2079,6179,6182,39,6184,4139,8236,6189,6190,47,8240,49,4149,9,8249,58,6495,4157,8885,6210,2115,68,74,8267,6221,2127,4176,1720,6228,1721,2526,4185,8283,8285,6241,6244,4200,105,8299,108,5138,1913,8305,8306,778,2172,6270,6271,2176,2177,2178,2180,2181,6283,4237,8334,9581,146,6291,6293,8900,4255,4257,8356,4261,6312,1736,6322,8374,2235,2236,6334,5152,4293,8459,4296,4301,6352,6354,4312,217,6362,8411,4316,221,6366,2271,2768,6371,2280,4329,2286,239,1781,6388,8437,247,4344,8442,253,3043,6400,6487,6405,2941,2092,8458,2315,4369,6624,3801,280,8474,285,8479,555,6434,4388,1414,4390,9265,6440,2345,298,4395,6444,9762,4405,4407,2362,6459,316,320,4417,2370,324,9270,329,330,331,693,8331,341,8281,6489,2394,7567,2396,8543,8251,2405,2407,6504,4457,8741,6512,8564,376,377,4474,2427,7422,4482,8579,8581,391,392,4489,396,1090,4494,8591,4500,8599,4505,8604,44,416,8611,420,423,4521,4522,6571,429,9288,8626,2484,2487,3658,8633,6586,1439,2492,6590,2495,4545,2498,2500,6597,4553,6606,4107,6609,5881,8665,6618,8670,479,4576,6699,4578,4581,4584,6634,4587,4588,2541,6468,6640,8689,6642,6569,504,5186,4603,2474,2560,513,6760,6662,2568,6668,2573,2477,4184,6675,4628,534,535,2585,543,4645,433,8746,4651,2604,8749,4655,4657,562,8764,6717,5952,3497,7947,8339,4677,582,6731,8781,8782,591,8785,2642,6739,596,8789,4696,2650,604,7610,606,6753,614,8807,2664,8201,623,4720,626,8819,2677,4728,788,6778,4731,21,6783,640,8833,1027,8838,2700,4750,4751,2704,4753,2707,4761,111,6813,4768,7280,2722,8867,6823,2728,3868,6828,6829,686,7615,8884,2741,694,8888,4793,9298,2759,712,6857,8909,8912,8916,4821,2778,6880,2786,741,4561,2796,6367,2800,4594,756,4853,4857,6906,4223,765,6910,3367,771,8964,6920,4874,4226,4880,787,6932,6934,6939,2845,4895,6944,9691,6948,7460,808,9692,4909,817,3012,6964,821,6233,823,824,2876,830,9024,480,3301,4933,1505,842,845,2824,9041,4946,1223,9051,7004,4958,7010,867,2917,7014,7016,9067,876,2926,488,4978,4979,4980,7998,886,2938,891,7037,895,4928,5008,9091,2949,9094,5002,2955,6986,2957,7054,5895,9106,7061,5615,7069,2213,7076,4941,9127,3911,9133,3782,7942,947,9141,9145,3004,4938,3007,9154,7108,7109,7118,3023,976,978,982,3031,9176,5081,5082,5083,7132,8698,5086,991,3041,5091,9188,7141,5095,3050,7335,850,5103,9202,3059,7678,7158,1015,3064,7161,5116,9386,3072,5123,3926,5130,1035,7180,3085,1038,9234,1054,3103,9248,6650,1058,8710,3114,1067,9262,9264,3121,3124,9269,3126,5175,9272,3129,9274,5183,3138,3254,5192,2572,3147,866,9296,1106,3155,5204,7256,4623,9061,3169,3173,9320,7880,5232,9330,2579,4286,6994,7294,5247,9345,9347,7301,5256,7306,1559,8904,3213,9359,1168,7315,3221,1180,3232,3233,9378,5287,7337,3242,1195,9392,9519,9398,3259,7357,5312,3267,7364,5317,9415,2973,7714,5701,1235,1237,7383,9435,1247,5346,9445,5350,7399,1261,3310,5359,3315,9463,9385,6698,5374,3327,7427,2945,7433,7435,3340,1475,1295,7443,3348,7446,9496,9502,3359,5409,1314,1316,1318,6705,3368,7465,5418,1325,5422,4317,1928,7476,5430,9528,3385,5434,5435,1340,1343,9536,9537,9538,907,227,5446,3400,3403,3298,1358,7504,5459,9557,1367,5464,3418,5468,5469,1375,2960,1378,9573,9574,3432,5482,3437,7534,3440,1393,1395,7544,9593,1403,3452,7550,5503,3456,576,3460,7558,577,3466,9612,9613,5518,5357,3472,5524,9621,9624,3481,9627,1437,7749,7585,9641,7598,9117,1458,7603,3509,9658,5565,7614,4341,7619,5575,9216,9673,7628,9678,1491,6734,3542,7483,5594,6735,3548,9694,9696,5601,1506,7652,9702,4689,7657,3563,9708,3666,3567,5617,9714,3571,6398,3574,5623,2644,7677,9726,1535,7681,3586,4011,3120,5640,8303,1548,7695,3602,4007,7703,5656,9754,7707,1564,9757,1567,5665,3618,1571,5668,9772,9773,9780,3637,5698,3651,3653,7751,5706,1611,9804,7757,7828,5715,6073,1627,5724,9821,5728,7777,7780,1638,3686,9832,7100,9834,1645,5742,7101,8808,1650,9844,5749,5753,1659,1642,9854,5759,7810,5766,9863,7816,3109,7820,5780,9879,3736,9881,4719,7838,7842,3697,5800,2989,1953,7852,5876,3761,9907,7860,5813,3768,7796,3774,9920,5827,1733,9926,9928,3785,9930,5839,1745,5844,1751,9944,5849,7899,3804,1757,9950,3807,5860,3813,5862,5864,9963,3264,1775,7920,59,7861,1780,3829,1783,9977,1663,5885,9982,9607,1798,9991,3851,6786,1808,5912,1819,7964,7903,7969,7971,5924,9862,9199,9180,7983,5768,3894,7993,1852,5790,3903,3904,3906,130,5959,3724,8013,8019,8022,5387,5977,8026,8028,1885,3387,8039,8040,1899,1900,3950,1903,4155,1906,6004,1910,609,1684,6010,9535,8060,5098,8062,6016,6018,8067,5315,3976,8514,8079,8657,3987,7833,8516,2031,1949,8517,4001,8099,7494,1958,6055,8105,8107,1010,6063,9203,6068,9886,8119,1977,4026,6076,8130,1355,8132,8134,8137,4043,1996,4770,1998,2000,4050,5113,3065,8153,7223,6750,4062,8161,6114,8165,6118,6121,4077,6127,2033,2034,8179,9615,4086,4087,2040,2042,2389]
)
print test.largestComponentSize(
    [2048,4097,6146,6486,7,10,6155,2061,16,4113,6163,2068,2069,24,2073,26,29,5125,34,6180,8230,40,6185,6187,6190,9617,4151,2104,2107,4158,5813,64,8257,6212,8262,9004,8265,2122,4174,4177,6499,4180,88,89,6235,8286,4191,96,4195,2049,2150,2153,5459,6252,4116,8321,3465,8328,5129,8332,8335,8338,8342,6296,153,4250,8348,4255,2210,619,2212,8357,2215,8360,8361,711,173,8904,182,8375,6329,4282,6333,190,4287,4291,4293,2247,200,6349,2254,4306,4576,2266,4316,2269,2271,6369,4323,6182,230,4328,6381,238,2288,8915,4340,9419,4345,4347,256,2091,8456,266,2315,6413,4366,1100,8467,46,8471,7556,6427,4382,6431,2336,2338,6436,6437,6438,3121,2346,8491,8499,2357,4406,9609,6456,313,6462,2367,8512,8514,4419,2374,2103,8525,4430,8529,1763,8532,4438,2391,8538,2395,350,8544,354,4451,4453,4454,2407,8552,6506,8555,4460,6509,2417,2421,2422,375,4473,4477,8574,6549,4482,4483,8580,4486,3137,2442,8587,6541,9965,400,2449,6546,1091,405,4502,408,8260,6555,4509,2468,421,8614,6629,6573,6574,4528,2803,6580,3145,756,2538,452,2129,455,6138,2505,2509,6606,463,8656,467,220,471,474,6619,477,4574,2528,6625,4578,4518,4583,1380,4586,4588,7250,8686,496,221,5886,5546,4606,4607,5888,6659,699,4614,4616,6667,6668,2574,2575,8280,3973,2585,540,8733,2591,2480,399,6694,554,8754,8755,567,2617,4667,6922,6719,577,4876,4683,8781,8885,4695,8793,7951,2652,9772,8803,6756,6757,2663,4712,2665,8810,4715,2672,628,4725,630,631,8825,637,8831,641,8835,644,646,108,2698,6795,4751,656,792,658,8852,3866,674,675,2341,683,8876,4783,6834,692,6942,6838,695,6483,6943,700,6845,3092,6848,5579,8900,801,712,2761,6775,6861,6863,4817,1456,4821,5957,9337,730,4827,8925,6878,2784,8933,8938,8940,2797,750,752,808,1491,4852,4859,6908,2858,2685,2818,4867,9686,4663,778,6924,4877,8978,8984,8986,8987,1583,8990,4895,6944,8993,2850,803,6950,4904,9002,6955,777,814,4911,6960,7304,9010,9011,6964,9013,6974,831,9025,9028,4933,9031,6984,2889,9034,1460,1801,9037,2895,2898,9043,4948,4949,4950,4954,9055,7008,2915,2917,4966,9063,2920,4971,2924,9073,4979,4981,489,4985,7036,893,895,7804,898,2947,900,902,904,5002,5003,908,7053,2959,912,2962,3566,7064,2972,9117,927,2976,2977,931,7076,2981,9133,7325,7088,9141,5050,5053,6033,3011,9156,8761,3019,5897,973,7119,7121,7122,9648,7125,7128,5090,7675,5092,3046,1000,1002,9195,5103,1010,6995,5108,3061,7158,5113,9213,9218,1028,854,3078,513,3081,9230,3089,5138,3091,1044,1047,3101,3103,3105,1059,5157,1062,1201,7208,7605,520,3122,9737,3128,1082,3132,7230,9279,7233,9283,7237,3143,9289,9290,2231,5196,1103,3153,9298,867,9300,7255,5208,8719,6330,7263,1120,7267,3174,1128,5226,1131,9324,3183,9331,5236,7285,9336,5241,5971,1215,5903,5251,3205,1160,5996,2258,9361,3220,1902,3224,5273,5274,1181,1182,7328,5282,244,3240,3244,1197,3249,9516,7027,7349,3109,3262,9407,1217,5323,3269,1223,5320,1225,518,8055,9420,1229,3281,5332,9429,3286,1239,7386,3291,7388,1246,7392,9442,3299,7396,9449,9450,3308,1261,9454,1267,3316,7416,7419,5372,7381,9999,1283,7428,9430,3335,5385,5389,3344,5393,7442,5396,4523,3351,3352,7451,5404,1925,1312,1584,3363,1319,1321,1322,1323,3372,5421,2840,3375,5000,9526,9527,9528,9529,5436,5438,9536,1345,9539,9540,9782,7494,8759,9549,3406,9555,7509,7511,5469,7518,5472,3425,3428,8081,5483,1751,1391,9586,3443,3444,1398,3388,5496,183,5502,1407,5504,3457,5508,6721,7561,7685,5912,4333,3472,2968,5525,1275,3480,3483,7584,3490,3491,7588,8436,7591,9640,5020,1450,5703,5548,5550,5552,5553,6484,3508,9653,6729,1465,7613,7614,1471,5568,9671,9673,8710,7627,1484,7634,4003,5588,1494,1495,7640,3547,3555,391,1073,3558,3559,5609,3564,9710,9714,7667,7669,7672,7674,9723,1533,7679,9732,1541,6939,7689,9738,5645,1551,3602,7699,1557,9190,5658,943,5666,9763,7718,9767,9769,9770,5675,3628,9775,7728,1588,7734,3639,1592,3641,5691,7742,9824,5699,1606,7751,1608,5708,5713,5716,7772,7773,9823,1632,5729,1350,1637,1980,3691,9846,5752,5753,5754,1660,5757,7807,3712,3714,5763,7813,7814,1675,5773,9873,5778,9878,3739,5789,8133,7217,5803,5804,3760,5809,9907,2334,7866,8479,9918,9504,3782,5834,3787,9934,1743,7888,5841,3794,5991,3796,5847,1752,5849,1754,5071,3706,3806,293,3810,5859,4390,1768,9961,295,3821,8829,7921,9973,9743,3833,1790,9983,1792,3841,7468,5900,3855,3858,7955,3861,3864,7962,1629,7971,7976,1834,4061,1425,7985,3892,3894,3895,7993,5946,5948,7999,3905,5954,1859,6063,5961,5963,5964,8015,6900,3923,1878,1882,3931,3936,3941,8038,4753,5993,2023,3948,7826,3950,8047,8048,3953,3956,3959,3337,3969,3734,1928,6025,3985,8082,8084,3989,1943,1944,883,1949,5787,6052,1957,6054,4010,4011,1964,9885,6217,4021,4028,475,4031,8128,1986,3403,1988,3062,6088,1994,1998,1357,4049,4051,6100,2007,4057,8523,4059,3272,8186,6112,2863,2020,4071,4072,4074,4075,2029,5117,8251,8178,8179,1227,6136,340,2042,4091,2864]
)